<Window x:Class="CashBatch.Desktop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="CashBatch" Height="720" Width="1200">
    <DockPanel>
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_Settings">
                <MenuItem Header="_Export..." Command="{Binding OpenExportSettingsCommand}" />
            </MenuItem>
        </Menu>
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="8">
            <Button Content="Import Bank File" Command="{Binding ImportCommand}" Margin="0,0,8,0" IsEnabled="{Binding IsBusy, Converter={StaticResource BooleanNegationConverter}}"/>
            <Button Content="Auto-Apply All" Command="{Binding AutoApplyCommand}" Margin="0,0,8,0" IsEnabled="{Binding IsBusy, Converter={StaticResource BooleanNegationConverter}}"/>
            <Button Content="Export Auto-Applied" Command="{Binding ExportCommand}" Margin="0,0,8,0" IsEnabled="{Binding IsBusy, Converter={StaticResource BooleanNegationConverter}}"/>
            <Button Content="Print Batch Summary" Command="{Binding PrintCommand}" IsEnabled="{Binding IsBusy, Converter={StaticResource BooleanNegationConverter}}"/>
            <TextBlock Margin="12,0,0,0" VerticalAlignment="Center" Text="Processing..." Visibility="{Binding IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}"/>
        </StackPanel>

        <TabControl Margin="8" SelectedIndex="{Binding SelectedTabIndex, Mode=TwoWay}">
            <TabItem Header="Batches">
                <DataGrid ItemsSource="{Binding Batches}" SelectedItem="{Binding SelectedBatch}" IsReadOnly="True"/>
            </TabItem>
            <TabItem Header="Payments">
                <DockPanel>
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="0,0,0,8">
                        <Button Content="Assign Customer" Command="{Binding AssignCustomerCommand}" />
                    </StackPanel>
                    <DataGrid ItemsSource="{Binding Payments}" SelectedItem="{Binding SelectedPayment, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTemplateColumn Header="" Width="30">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Ellipse Width="12" Height="12">
                                        <Ellipse.Style>
                                            <Style TargetType="Ellipse">
                                                <Setter Property="Fill" Value="Transparent" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Status}" Value="AutoApplied">
                                                        <Setter Property="Fill" Value="LimeGreen"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Ellipse.Style>
                                    </Ellipse>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Check #" Binding="{Binding CheckNumber}" Width="*" />
                        <DataGridTextColumn Header="Remitter Name" Binding="{Binding RemitterName}" Width="*" />
                        <DataGridTextColumn Header="City" Binding="{Binding City}" Width="140" />
                        <DataGridTextColumn Header="Invoice #" Binding="{Binding InvoiceNumber}" Width="160" />
                        <DataGridTextColumn Header="Bank Number" Binding="{Binding BankNumber}" Width="160" />
                        <DataGridTextColumn Header="Account Number" Binding="{Binding AccountNumber}" Width="160" />
                        <DataGridTemplateColumn Header="Cust # File" Width="*">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding CustomerId}" ToolTip="{Binding OriginalCustomerId}">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="Normal" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsLookupCustomer}" Value="True">
                                                        <Setter Property="FontWeight" Value="Bold" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Amount" Binding="{Binding Amount}" Width="120" />
                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="120" />
                    </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </TabItem>

            <TabItem Header="Applied Detail">
                <DataGrid ItemsSource="{Binding AppliedLines}" AutoGenerateColumns="False" IsReadOnly="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Invoice #" Binding="{Binding InvoiceNo}" Width="*" />
                        <DataGridTextColumn Header="Net Due Date" Binding="{Binding NetDueDate, StringFormat=MM/dd/yyyy}" Width="140" />
                        <DataGridTextColumn Header="Amount Remaining" Binding="{Binding AmountRemaining}" Width="160" />
                        <DataGridTextColumn Header="Freight Allowed" Binding="{Binding FreightAllowedAmt}" Width="150" />
                        <DataGridTextColumn Header="Terms Amount" Binding="{Binding TermsAmount}" Width="150" />
                        <DataGridTextColumn Header="Applied Amount" Binding="{Binding AppliedAmount}" Width="150" />
                        <DataGridCheckBoxColumn Header="Auto-Matched" Binding="{Binding WasAutoMatched}" Width="120" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="Needs Review">
                <DataGrid ItemsSource="{Binding NeedsReviewPayments}" />
            </TabItem>
            <TabItem Header="Logs">
                <DataGrid ItemsSource="{Binding Logs}" />
            </TabItem>
            <TabItem Header="Customer Lookups">
                <DataGrid ItemsSource="{Binding Lookups}" />
            </TabItem>
        </TabControl>
    </DockPanel>
</Window>
